<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Control Flow | Advanced R Companion</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Control Flow | Advanced R Companion" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Control Flow | Advanced R Companion" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="R4DS Reading Group" />


<meta name="date" content="2020-05-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="subsetting.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<img src="images/r4ds.png" style="width:300px;height:180px;padding-bottom:0px;"></img>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="names-and-values.html"><a href="names-and-values.html"><i class="fa fa-check"></i><b>2</b> Names and Values</a><ul>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#copy-on-modify"><i class="fa fa-check"></i>2.3 Copy-on-modify</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#exercises"><i class="fa fa-check"></i>2.2.2 Exercises</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#function-calls"><i class="fa fa-check"></i>2.3.2 Function calls</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#lists_2"><i class="fa fa-check"></i>2.3.3 Lists</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#character-vectors"><i class="fa fa-check"></i>2.3.5 Character vectors</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#exercise"><i class="fa fa-check"></i>2.3.6.2 Exercise</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#object-size"><i class="fa fa-check"></i>2.4.1 Object size</a></li>
<li class="chapter" data-level="" data-path="names-and-values.html"><a href="names-and-values.html#modify-in-place"><i class="fa fa-check"></i>2.5.1 Modify-in-place</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>3</b> Vectors</a><ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#scalars"><i class="fa fa-check"></i>3.2.1 Scalars</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#missing-values"><i class="fa fa-check"></i>3.2.3 Missing values</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#testing-and-coercion"><i class="fa fa-check"></i>3.2.4 Testing and coercion</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#setting-attributes"><i class="fa fa-check"></i>3.3.1 Setting Attributes</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#setnames"><i class="fa fa-check"></i>3.3.2 setNames</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#dimensions"><i class="fa fa-check"></i>3.3.3 Dimensions</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#s3-atomic-vectors"><i class="fa fa-check"></i>3.4 S3 atomic vectors</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#dates"><i class="fa fa-check"></i>3.4.2 Dates</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#lists"><i class="fa fa-check"></i>3.5.1 Lists</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#data-frames-and-tibbles"><i class="fa fa-check"></i>3.6.8 Data frames and tibbles</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#conclusion"><i class="fa fa-check"></i>Conclusion</a><ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#vectorized"><i class="fa fa-check"></i>VECTORIZED:</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#non-vectorized"><i class="fa fa-check"></i>NON-VECTORIZED:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a><ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#introduction"><i class="fa fa-check"></i>4.1 Introduction</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#selecting-multiple-elements"><i class="fa fa-check"></i>4.2.1 Selecting multiple elements</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#lists_4"><i class="fa fa-check"></i>4.2.2 lists</a></li>
<li><a href="subsetting.html#subset_2">4.3.1 <code>[[</code></a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#exercise_435"><i class="fa fa-check"></i>4.3.5 Exercise</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#missing-and-oob"><i class="fa fa-check"></i>4.3.3 Missing and OOB</a><ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#logical-atomic"><i class="fa fa-check"></i>LOGICAL ATOMIC</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#lists_missing"><i class="fa fa-check"></i>LIST</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#null"><i class="fa fa-check"></i>NULL</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#logical-subsetting"><i class="fa fa-check"></i>4.5.8 Logical subsetting</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra"><i class="fa fa-check"></i>4.5.8 Boolean algebra</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>5</b> Control Flow</a><ul>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#vectorised-if"><i class="fa fa-check"></i>5.2.2 Vectorised if</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i>5.3 Loops</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#switch"><i class="fa fa-check"></i>5.2.3 switch statement</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#common-pitfalls"><i class="fa fa-check"></i>5.3.1 common pitfalls</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#exercise5331"><i class="fa fa-check"></i>5.3.3.1 Exercises</a><ul>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#assignment-valid"><i class="fa fa-check"></i>Assignment to a valid index</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#assignment-0"><i class="fa fa-check"></i>Assignment to [0]</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#empty-index"><i class="fa fa-check"></i>Empty index</a></li>
<li><a href="control-flow.html#impossible-double">Impossible Index <code>[[</code></a></li>
<li><a href="control-flow.html#impossible-double-assign">Impossible Index <code>[[&lt;-</code></a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#undefined-5"><i class="fa fa-check"></i>Undefined name</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#oob-5"><i class="fa fa-check"></i>Out of Bounds</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#conclusion-5"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R Companion</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="control-flow" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Control Flow</h1>
<div id="vectorised-if" class="section level2 unnumbered">
<h2>5.2.2 Vectorised if</h2>
<div class="question">
<p>Why does <code>if</code> <code>else</code> print <code>&quot;Out of range&quot;</code> once but <code>ifelse</code> prints it twice?</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="cf">if</span> (<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">print</span>(<span class="st">&quot;In range&quot;</span>) <span class="cf">else</span> <span class="kw">print</span>(<span class="st">&quot;Out of range&quot;</span>)</a></code></pre></div>
<pre><code>[1] &quot;Out of range&quot;</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="kw">ifelse</span>((<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">print</span>(<span class="st">&quot;In range&quot;</span>), <span class="kw">print</span>(<span class="st">&quot;Out of range&quot;</span>))</a></code></pre></div>
<pre><code>[1] &quot;Out of range&quot;
[1] &quot;Out of range&quot;</code></pre>
</div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1">var &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">print</span>(<span class="st">&quot;In range&quot;</span>)</a>
<a class="sourceLine" id="cb178-2" data-line-number="2">var</a></code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">var &lt;-<span class="st"> </span><span class="kw">ifelse</span>((<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">print</span>(<span class="st">&quot;In range&quot;</span>), <span class="kw">print</span>(<span class="st">&quot;Out of range&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;Out of range&quot;</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1">var</a></code></pre></div>
<pre><code>## [1] &quot;Out of range&quot;</code></pre>
<p><code>ifelse</code> explicitly returns its result, whereas <code>if</code> invisibly returns it!</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">ifelse</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 1 3 1</code></pre>
<p>Honestly, <code>ifelse()</code> is weird. Try this too:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="kw">ifelse</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 1 3 3</code></pre>
</div>
<div id="loops" class="section level2 unnumbered">
<h2>5.3 Loops</h2>
<div class="question">
<p>Can the body of the loop change the set?</p>
</div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">my_set &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">99</span>)</a>
<a class="sourceLine" id="cb188-2" data-line-number="2"></a>
<a class="sourceLine" id="cb188-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> my_set){</a>
<a class="sourceLine" id="cb188-4" data-line-number="4">  <span class="cf">if</span> (i<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb188-5" data-line-number="5">    my_set[<span class="dv">9</span>]=<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb188-6" data-line-number="6">    }</a>
<a class="sourceLine" id="cb188-7" data-line-number="7">  <span class="kw">print</span>(<span class="st">&quot;hello&quot;</span>)</a>
<a class="sourceLine" id="cb188-8" data-line-number="8">  <span class="kw">print</span>(my_set)</a>
<a class="sourceLine" id="cb188-9" data-line-number="9">  }</a></code></pre></div>
<pre><code>## [1] &quot;hello&quot;
## [1]  1 20 99 NA NA NA NA NA 20
## [1] &quot;hello&quot;
## [1]  1 20 99 NA NA NA NA NA 20
## [1] &quot;hello&quot;
## [1]  1 20 99 NA NA NA NA NA 20</code></pre>
<p>Looks like you can’t!</p>
</div>
<div id="switch" class="section level2 unnumbered">
<h2>5.2.3 switch statement</h2>
<div class="question">
<p>“Closely related to if is the <code>switch()</code> statement. It’s a compact, special purpose equivalent”</p>
<p>What is meant here by “special purpose”? Can we come up with a case where you can’t substitute <code>if</code> for <code>switch</code> or the other way around? Use <code>switch</code>. Is it safe to say to <code>switch</code> when you have character inputs (as the book suggests) and use <code>case_when</code> or <code>if</code> for numerics?</p>
</div>
<p>Switch is special in that only ONE value can be true, as in the case from our presentation the shiny input can only ever be ONE of the strings on the left it cannot be multiple.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">datasetInput &lt;-<span class="st"> </span><span class="kw">reactive</span>({ </a>
<a class="sourceLine" id="cb190-2" data-line-number="2">  <span class="cf">switch</span>(input<span class="op">$</span>dataset,</a>
<a class="sourceLine" id="cb190-3" data-line-number="3">         <span class="st">&quot;materials&quot;</span> =<span class="st"> </span>brewing_materials,</a>
<a class="sourceLine" id="cb190-4" data-line-number="4">         <span class="st">&quot;size&quot;</span> =<span class="st"> </span>brewer_size,</a>
<a class="sourceLine" id="cb190-5" data-line-number="5">         <span class="st">&quot;states&quot;</span> =<span class="st"> </span>beer_states,</a>
<a class="sourceLine" id="cb190-6" data-line-number="6">         <span class="st">&quot;taxed&quot;</span> =<span class="st"> </span>beer_taxed)</a>
<a class="sourceLine" id="cb190-7" data-line-number="7">})</a></code></pre></div>
</div>
<div id="common-pitfalls" class="section level2 unnumbered">
<h2>5.3.1 common pitfalls</h2>
<div class="question">
<p>What does the book mean by leveraging <code>vector</code> for preallocating the loop output? How is this different from creating an empty list to instantiate the loop?</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb191-2" data-line-number="2"></a>
<a class="sourceLine" id="cb191-3" data-line-number="3">out_vector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(means))</a>
<a class="sourceLine" id="cb191-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(means)) {</a>
<a class="sourceLine" id="cb191-5" data-line-number="5">  out_vector[[i]] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, means[[i]])</a>
<a class="sourceLine" id="cb191-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb191-7" data-line-number="7"></a>
<a class="sourceLine" id="cb191-8" data-line-number="8">out_list &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb191-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(means)) {</a>
<a class="sourceLine" id="cb191-10" data-line-number="10">  out_list[[i]] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, means[[i]])</a>
<a class="sourceLine" id="cb191-11" data-line-number="11">}</a></code></pre></div>
</div>
<p>By preallocating the length of the <code>out_vector</code> we’re leveraging <code>modify-in-place</code> rather than <code>copy-on-modify</code>.</p>
<div class="question">
<p>The book warns against using <code>length(x)</code> and suggests using <code>seq_along</code> instead. Is there any downside to using <code>seq_along</code> or a case when you’d prefer <code>length(x)</code> over <code>seq_along(x)</code>? I can’t think of any downsides to using it!</p>
</div>
<div class="TODO">
<p>We have yet to find a downside but should look into this further!</p>
</div>
</div>
<div id="exercise5331" class="section level2 unnumbered">
<h2>5.3.3.1 Exercises</h2>
<div class="question">
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">numeric</span>()</a>
<a class="sourceLine" id="cb192-2" data-line-number="2">out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb192-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</a>
<a class="sourceLine" id="cb192-4" data-line-number="4">  out[i] &lt;-<span class="st"> </span>x[i] <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb192-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb192-6" data-line-number="6">out</a></code></pre></div>
<pre><code>## [[1]]
## [1] NA</code></pre>
<p>I understand that this works because we can count down in a loop - so the first iteration <code>x[1] == NA</code>, and the second <code>x[2] == numeric(0)</code> but where does this value go? Is it just evaluated but not stored since R counts from 1?</p>
</div>
<p>This question is actually the bigger question, “Can you assign something to index 0 in R?” and it doesn’t seem that you can.</p>
<div id="assignment-valid" class="section level3 unnumbered">
<h3>Assignment to a valid index</h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb194-2" data-line-number="2">mylist[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;something&quot;</span>)</a>
<a class="sourceLine" id="cb194-3" data-line-number="3">mylist[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;something&quot;</code></pre>
</div>
<div id="assignment-0" class="section level3 unnumbered">
<h3>Assignment to [0]</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb196-2" data-line-number="2">mylist[<span class="dv">0</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;something&quot;</span>)</a>
<a class="sourceLine" id="cb196-3" data-line-number="3">mylist[<span class="dv">0</span>]</a></code></pre></div>
<pre><code>## list()</code></pre>
<p>It’s interesting that it’s syntactically correct to assign to <code>mylist[0]</code> but it does nothing!</p>
</div>
<div id="empty-index" class="section level3 unnumbered">
<h3>Empty index</h3>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb198-2" data-line-number="2">mylist[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [[1]]
## NULL</code></pre>
<p>R defaultly accesses the first layer using <code>[</code> and says there are no elements in the first layer of <code>mylist</code> and returns <code>NULL</code>. But when you do <code>mylist[[1]]</code> R says <code>Out of Bounds</code> because the first layer of <code>mylist</code> has been called and there is no layer at all. That’s why R throws error in <code>[[</code> case.</p>
</div>
<div id="impossible-double" class="section level3 unnumbered">
<h3>Impossible Index <code>[[</code></h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb200-2" data-line-number="2">mylist[[<span class="dv">0</span>]]</a></code></pre></div>
<pre><code>Error in mylist[[0]] : attempt to select less than one element in get1index &lt;real&gt;</code></pre>
<p><code>[[</code> isolates one element whereas <code>[</code> can be used to get subsets of varying sizes.
<code>[[</code> gets precisely one element, no more no less, or it fails. So <code>[[0]]&lt;-</code> cannot work because index zero cannot hold a value.</p>
</div>
<div id="impossible-double-assign" class="section level3 unnumbered">
<h3>Impossible Index <code>[[&lt;-</code></h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb202-2" data-line-number="2">mylist[[<span class="dv">0</span>]] &lt;-<span class="st"> &quot;something&quot;</span></a></code></pre></div>
<pre><code>Error in mylist[[0]] &lt;- &quot;something&quot; : attempt to select less than one element in integerOneIndex</code></pre>
</div>
<div id="undefined-5" class="section level3 unnumbered">
<h3>Undefined name</h3>
<p>Selection using an undefined - but possible name - gives NULL</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb204-2" data-line-number="2">mylist[[<span class="st">&quot;undefined_name&quot;</span>]]</a></code></pre></div>
</div>
<div id="oob-5" class="section level3 unnumbered">
<h3>Out of Bounds</h3>
<p>Selection using a possible - but not currently allocated - index gives an out of bounds error</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">mylist =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb205-2" data-line-number="2">mylist[[<span class="dv">10</span>]]</a></code></pre></div>
<pre><code>Error in mylist[[10]] : subscript out of bounds </code></pre>
</div>
</div>
<div id="conclusion-5" class="section level2 unnumbered">
<h2>Conclusion</h2>
<div class="question">
<p>Can we put these concepts together in diagram form? Let’s work on improving these schematics!</p>
</div>
<p><img src="images/controlflow.png" width="1440" /></p>
<p>It is also important to note that unlike the other control flow statements, <code>ifelse</code> is vectorized – we can visualize the <code>ifelse</code> logic above operating on each element within a vector:</p>
<p><img src="images/ifelse.png" width="352" style="display: block; margin: auto;" /></p>
<p>For instance if we can run:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">ifelse</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 1 3 1</code></pre>
<p>Lets break down what’s happening:</p>
<p>Create a test answer:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1">test &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb209-2" data-line-number="2">yes &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb209-3" data-line-number="3">no &lt;-<span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<p>which indices in the test are TRUE and which are FALSE</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">yes_idx &lt;-<span class="st"> </span><span class="kw">which</span>(test) <span class="co"># 1,3</span></a>
<a class="sourceLine" id="cb210-2" data-line-number="2">no_idx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span>test) <span class="co"># 2</span></a></code></pre></div>
<p>set up our answer</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1">answer &lt;-<span class="st"> </span>test <span class="co"># T, F, T</span></a></code></pre></div>
<p>grow the yes and no answers to the length of the test (input)</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1">yes_final &lt;-<span class="st"> </span><span class="kw">rep</span>(yes, <span class="dt">length.out =</span> <span class="kw">length</span>(test))</a>
<a class="sourceLine" id="cb212-2" data-line-number="2">no_final &lt;-<span class="st"> </span><span class="kw">rep</span>(no, <span class="dt">length.out =</span> <span class="kw">length</span>(test))</a></code></pre></div>
<p>fill the answer with yes or no from the enlarged yes/no answers</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1">answer[yes_idx] &lt;-<span class="st"> </span>yes_final[yes_idx]  <span class="co"># 1,1</span></a>
<a class="sourceLine" id="cb213-2" data-line-number="2">answer[no_idx] &lt;-<span class="st"> </span>no_final[no_idx]     <span class="co"># 3</span></a></code></pre></div>
<p>return our final answer:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1">answer</a></code></pre></div>
<pre><code>## [1] 1 3 1</code></pre>
<p>Another example: we can run</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">ifelse</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="st">&quot;FALSE&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;1&quot;     &quot;FALSE&quot; &quot;3&quot;     &quot;FALSE&quot; &quot;5&quot;     &quot;6&quot;</code></pre>
<p>we can see that ifelse places the numbers in <code>1:10</code> based on their index where our condition is to <code>TRUE</code> and inserts the string <code>&quot;FALSE&quot;</code> whenever the condition is <code>FALSE</code></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="subsetting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-control_flow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["AdvancedR_Companion.pdf", "AdvancedR_Companion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
